<div class="gameArea" #gameArea></div>

<div class="areaCode" style="background-color: #3d6227">
  <div align="center">
    <table cellpadding="0" cellspacing="0" style="width: calc(100vw - 800px); height: calc(60vh + 50px);">
      <tr>
        <td style="vertical-align: bottom">

          <div class="text-end pb-1">
            <img (click)="abrirMenuLateral()" alt="menu" title="Abrir Menu" class="open-menu" src="assets/images/icones/hamburguergreen.png"/>
          </div>

          <ace-editor class="ace-editor"
            #editor
            (textChange)="mudouTexto($event)"
            style="height: 60vh; width:100%;"></ace-editor>
        </td>
      </tr>
    </table>
  </div>
  <div align="center">
    <table style="width: calc(100vw - 800px); height: calc(100vh - calc(60vh + 50px))">
      <tr>
        <td style="width: 25%; text-align: center">
          <table>
            <tr>
              <td></td>
              <td>
                <div class="direction-control" (click)="inserirComando(normalizarComando('up'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="UP" title="UP" class="up">
                </div>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <div class="direction-control" (click)="inserirComando(normalizarComando('left'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="LEFT" title="LEFT" class="left">
                </div>
              </td>
              <td></td>
              <td>
                <div class="direction-control float-start" (click)="inserirComando(normalizarComando('right'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="RIGHT" title="RIGHT" class="right">
                </div>
              </td>
            </tr>
            <tr>
              <td></td>
              <td>
                <div class="direction-control" (click)="inserirComando(normalizarComando('down'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="DOWN" title="DOWN" class="down">
                </div>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
        <td style="width: 37.5%;">
          <div class="play-button float-end" (click)="readConsoleText()" *ngIf="!isRunning">
            <img src="https://images.vexels.com/media/users/3/136986/isolated/preview/1267b92546dd4569214069b4ed32f70e-ponta-de-seta-de-triangulo-espesso.png" alt="play" title="Executar código" class="img-button-play">
          </div>

          <div class="play-button pause float-end" (click)="stopExecution()" *ngIf="isRunning">
            <img src="https://iconsplace.com/wp-content/uploads/_icons/ff0000/256/png/stop-icon-14-256.png" alt="stop" title="Parar execução do código" class="img-button-play pause">
          </div>
        </td>
        <td style="width: 37.5%;">
          <div class="reset-button float-end" (click)="resetCode()">
            <img src="https://icons.veryicon.com/png/o/miscellaneous/component-usage/reset-16.png" alt="reiinicial código" title="Reinicial código" class="img-button-reset">
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>

<ng-template #modalFimDeFase>
  <div class="modal-content">
    <div class="modal-header bg-success">
      <h4 class="modal-title text-white">
        Nível Concluído
      </h4>
    </div>
    <div class="modal-body p-4">

      <div class="row">
        <div class="col-md-12">
          <strong>Quantidade de passos: </strong>
          {{endGameInformations?.steps}}
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">
          <strong>Quantidade de comandos: </strong>
          {{endGameInformations?.usedsCommands?.length || 0}}
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">
          <strong>Tempo: </strong>
          {{endGameInformations?.timeInSeconds}} segundos
        </div>
      </div>

    </div>
  </div>
  <div class="row mt-3 mb-3 me-3">
    <div class="col-12 col-md-12" style="text-align: right">
      <button class="btn btn-success me-2" [disabled]="!endGameInformations?.collectedElements?.length" (click)="nextPhase()">
        Próxima
      </button>

      <button class="btn btn-secondary" (click)="stopExecution()">
        Reiniciar
      </button>
    </div>
  </div>
</ng-template>

<ng-template #modalTutorial style="background-color: transparent">
  <div class="modal-content p-0" style="background-color: transparent">
    <div class="modal-body p-0" style="background-color: transparent">
      <div style="overflow: hidden; background-color: #310c7c; border-radius: 50px 50px 0px 0px; height: 300px; width: 700px; position: absolute; top: calc(600px - 300px); left: 0;">
        <div class="row">
          <div class="col-md-7">
            <img style="width: 100%" src="assets/images/personagem.gif"> <!-- https://media.discordapp.net/attachments/593811885787447297/942190906424049724/sapo.png -->
          </div>
          <div class="col-md-5 text-white">
            <table style="width: 100%; height: 300px;">
              <tr>
                <td style="text-align: justify; padding-right: 30px; height: 220px;">
                  <span style="font-size: large">
                    {{modalTexts[indexText]}}

                    <div *ngIf="indexText == 3" class="pt-3 text-center">
                      <img src="https://media.discordapp.net/attachments/593811885787447297/938532710081790014/ag.png" style="width: 50px" alt="prata" title="Ag (prata)">
                    </div>
                  </span>
                </td>
              </tr>
              <tr>
                <td style="text-align: left; padding-right: 30px; height: 35px;">
                  <img alt="próximo" (click)="changeText()" style="height: 35px; cursor: pointer" title="Próximo" src="https://images-ext-1.discordapp.net/external/7CigmzdGxQa3pDMpmp2ShO0_pePVwDS5kMrXdDdkSeQ/https/cdn-icons-png.flaticon.com/512/2026/2026919.png">
                </td>
              </tr>
              <tr>
                <td style="text-align: right; padding-right: 30px; height: 45px;">
                  <span class="pular-tudo" (click)="closeModalTutorial()"></span>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<right-side-bar-component [scene]="scene"></right-side-bar-component>
