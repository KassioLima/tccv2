<div class="gameArea" #gameArea></div>

<div class="areaCode" style="background-color: #3d6227">
  <div align="center">
    <table cellpadding="0" cellspacing="0" style="width: calc(100vw - 800px); height: calc(60vh + 50px);">
      <tr>
        <td style="vertical-align: bottom">

          <div class="text-end pb-1">
            <img (click)="abrirMenuLateral()" alt="menu" title="Abrir Menu" class="open-menu" src="assets/images/icones/hamburguergreen.png"/>
          </div>

          <ace-editor class="ace-editor"
            #editor
            (textChange)="mudouTexto($event)"
            style="height: 60vh; width:100%;"></ace-editor>
        </td>
      </tr>
    </table>
  </div>
  <div align="center">
    <table style="width: calc(100vw - 800px); height: calc(100vh - calc(60vh + 50px))">
      <tr>
        <td style="width: 25%; text-align: center">
          <table>
            <tr>
              <td></td>
              <td>
                <div class="direction-control" (click)="inserirComando(normalizarComando('up'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="UP" title="UP" class="up">
                </div>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <div class="direction-control" (click)="inserirComando(normalizarComando('left'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="LEFT" title="LEFT" class="left">
                </div>
              </td>
              <td></td>
              <td>
                <div class="direction-control float-start" (click)="inserirComando(normalizarComando('right'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="RIGHT" title="RIGHT" class="right">
                </div>
              </td>
            </tr>
            <tr>
              <td></td>
              <td>
                <div class="direction-control" (click)="inserirComando(normalizarComando('down'))">
                  <img src="https://imagensemoldes.com.br/wp-content/uploads/2020/04/Emoji-Seta-PNG-1024x1024.png" alt="DOWN" title="DOWN" class="down">
                </div>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
        <td style="width: 37.5%;">
          <div class="play-button float-end" (click)="readConsoleText()" *ngIf="!isRunning">
            <img src="https://images.vexels.com/media/users/3/136986/isolated/preview/1267b92546dd4569214069b4ed32f70e-ponta-de-seta-de-triangulo-espesso.png" alt="play" title="Executar código" class="img-button-play">
          </div>

          <div class="pause-button pause float-end" (click)="stopExecution()" *ngIf="isRunning">
            <img src="https://iconsplace.com/wp-content/uploads/_icons/ff0000/256/png/stop-icon-14-256.png" alt="stop" title="Parar execução do código" class="img-button-play pause">
          </div>
        </td>
        <td style="width: 37.5%;">
          <div class="reset-button float-end" (click)="resetCode()">
            <img src="https://icons.veryicon.com/png/o/miscellaneous/component-usage/reset-16.png" alt="reiinicial código" title="Reinicial código" class="img-button-reset">
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>

<ng-template #modalFimDeFase>
  <div class="modal-content p-0">
    <div class="modal-body p-0">
      <table cellpadding="0" cellspacing="0" style="height: 100vh; width: 100vw">
        <tr>
          <td style="text-align: center">
            <div class="text-white p-4 text-start content-fim-fase text-center">
              <div class="row">
                <div class="col-md-12">
                  <div>
                    <img src="assets/images/game/estrelas/estrela cheia.png" class="star-end-phase" *ngFor="let star of filtraEstrelas('cheia')">
                    <img src="assets/images/game/estrelas/meia estrela.png" class="star-end-phase" *ngFor="let star of filtraEstrelas('meia')">
                    <img src="assets/images/game/estrelas/estrela vazia.png" class="star-end-phase" *ngFor="let star of filtraEstrelas('vazia')">
                  </div>
                </div>
              </div>

              <br>

              <div style="padding: 15px; margin-bottom: 50px; margin-top: 5px;">
              <table style="width: 100%;">
                <tr>
                  <td style="width: 33%">
                    <table style="height: 230px; width: 100%">
                      <tr>
                        <td>
                          <table>
                            <tr>
                              <td>
                                <img src="{{'assets/images/game/pe/' + getCorPassos() + '.png'}}" style="width: 30px;">
                              </td>
                            </tr>
                            <tr>
                              <td style="color: #{{getCorPassos()}}">{{endGameInformations?.steps}} passos</td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <table>
                            <tr>
                              <td>
                                <img src="{{'assets/images/game/comandos/' + getCorComandos() + '.png'}}" style="width: 30px"></td>
                            </tr>
                            <tr>
                              <td style="color: #{{getCorComandos()}}">{{endGameInformations?.usedsCommands?.length || 0}} comandos</td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                  </td>

                  <td style="width: 33%"><img style="height: 230px" src="assets/images/personagem.gif"></td>

                  <td style="width: 33%">
                    <table style="height: 230px; width: 100%">
                      <tr>
                        <td>
                          <table style="float: right">
                            <tr>
                              <td>
                                <img src="{{'assets/images/game/tempo/' + getCorTempo() + '.png'}}" style="width: 30px">
                              </td>
                            </tr>
                            <tr>
                              <td style="color: #{{getCorTempo()}}">{{endGameInformations?.timeInSeconds}} segundos</td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <table style="float: right">
                            <tr>
                              <td><img src="{{'assets/images/game/elemento/' + getCorElementos() + '.png'}}" style="width: 30px;"></td>
                            </tr>
                            <tr>
                              <td style="color: #{{getCorElementos()}}">{{endGameInformations?.collectedElements?.length || 0}} elementos</td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
              </div>

              <div class="row mt-0 mb-3">
                <div class="col-12 col-md-12" style="text-align: center">
                  <img src="assets/images/game/repeat.png" alt="Reiniciar" title="Tentar Novamente" (click)="stopExecution()" class="pointer me-5 button-modal-fim-de-fase">
                  <img src="assets/images/game/next.png" alt="Próxima fase" title="Próxima fase" [ngClass]="{'opacity-50': !objetivoConcluido()}" (click)="nextPhase()" class="pointer button-modal-fim-de-fase">
                </div>
              </div>
            </div>
          </td>
        </tr>
      </table>
    </div>
  </div>
</ng-template>

<ng-template #modalTutorial style="background-color: transparent">
  <div class="modal-content p-0" style="background-color: transparent">
    <div class="modal-body p-0" style="background-color: transparent">
      <div style="overflow: hidden; background-color: #310c7c; border-radius: 50px 50px 0px 0px; height: 300px; width: 700px; position: absolute; top: calc(600px - 300px); left: 0;">
        <div class="row">
          <div class="col-md-7">
            <img style="width: 100%" src="assets/images/personagem.gif"> <!-- https://media.discordapp.net/attachments/593811885787447297/942190906424049724/sapo.png -->
          </div>
          <div class="col-md-5 text-white">
            <table style="width: 100%; height: 300px;">
              <tr>
                <td style="text-align: justify; padding-right: 30px; height: 220px;">
                  <span style="font-size: large">
                    {{modalTexts[indexText]}}

                    <div *ngIf="indexText == 3" class="pt-3 text-center">
                      <img src="https://media.discordapp.net/attachments/593811885787447297/938532710081790014/ag.png" style="width: 50px" alt="prata" title="Ag (prata)">
                    </div>
                  </span>
                </td>
              </tr>
              <tr>
                <td style="text-align: left; padding-right: 30px; height: 35px;">
                  <img alt="próximo" (click)="changeText()" style="height: 35px; cursor: pointer" title="Próximo" src="https://images-ext-1.discordapp.net/external/7CigmzdGxQa3pDMpmp2ShO0_pePVwDS5kMrXdDdkSeQ/https/cdn-icons-png.flaticon.com/512/2026/2026919.png">
                </td>
              </tr>
              <tr>
                <td style="text-align: right; padding-right: 30px; height: 45px;">
                  <span class="pular-tudo" (click)="closeModalTutorial()"></span>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<right-side-bar-component [scene]="scene"></right-side-bar-component>
